import{j as r,r as s}from"./react-BZuymhSV.js";import{H as e,U as t,e as o}from"./index-Cy3gUGUA.js";import{u as n}from"./react-router-dom-BFbt_rfn.js";import{d as a}from"./react-icons-BdjcCHud.js";import{a as i}from"./axios-XtWrBBVz.js";import{d as c}from"./validators-BtMPgszA.js";import"./react-dom-BYiVop1z.js";import"./scheduler-DhxmCZ7v.js";import"./@gsap-7rUOfEg6.js";import"./gsap-BDVyzZVq.js";import"./i18next-BuDUpmuK.js";import"./split-type-CbOXNKxF.js";import"./react-i18next-DjQM30kD.js";import"./swiper-bSAY_IpK.js";import"./react-toastify-BQnkcPH4.js";import"./clsx-BeLtu-UY.js";import"./@remix-run-CmyMgbGZ.js";const l={"settings-page":"_settings-page_bb400_1",button:"_button_bb400_12","logout-btn":"_logout-btn_bb400_37","spotify-btn":"_spotify-btn_bb400_53",icon:"_icon_bb400_68","change-password-from":"_change-password-from_bb400_71","input-wrapper":"_input-wrapper_bb400_79","back-link":"_back-link_bb400_98"},u=({logOut:s})=>{const e=n();return r.jsx("button",{onClick:()=>{s(),e("/")},className:`${l["logout-btn"]}`,children:"Log Out"})};i.defaults.withCredentials=!0;const d=()=>{const{user:o,setUser:n}=s.useContext(t),c=()=>{(async()=>{try{const r=await i.delete(`${e.CLIENT}/spotify/disconnect`,{withCredentials:!0});return 200!==r.status?{error:"Error during disconnecting from Spotify"}:r.data}catch(r){return{error:"Error during disconnecting from Spotify"}}})().then((r=>{r.error||n(r)}))};return o&&o.spotify?r.jsx("button",{className:`${l["spotify-btn"]} ${l.button}`,onClick:c,children:"Disconnect from Spotify"}):r.jsxs("button",{className:`${l["spotify-btn"]} ${l.button}`,onClick:()=>(async()=>{try{const r=await i.get(`${e.SPOTIFY}/spotify/login`,{withCredentials:!0});if(200!==r.status)return{error:"Error during connecting to Spotify"};const s=r.data;window.location.href=s}catch(r){return{error:"Error during connecting to Spotify"}}})(),children:[r.jsx(a,{className:l.icon}),"Connect to Spotify"]})},p=({setChangePassOpened:s})=>r.jsx("button",{className:l.button,onClick:()=>s(!0),children:"Change Password"}),m=({setChangePassOpened:e})=>{const[t,n]=s.useState(""),[a,i]=s.useState({value:"",error:""}),[u,d]=s.useState({value:"",error:""});s.useEffect((()=>{const r=c(a.value);i(r?{...a,error:r}:{...a,error:""}),a.value!==u.value?d({...u,error:"Passwords do not match"}):d({...u,error:""})}),[a.value,u.value]);return r.jsxs(r.Fragment,{children:[r.jsxs("form",{className:l["change-password-from"],onSubmit:async r=>{r.preventDefault();const s=await o(a.value,u.value);s.error?n(s.error):(n(""),e(!1))},children:[r.jsx("h2",{children:"Change Password"}),t.length>0&&r.jsx("span",{className:l.error,children:t}),r.jsxs("div",{className:l["input-wrapper"],children:[r.jsx("label",{htmlFor:"new-password",children:"New Password"}),a.value.length>0&&r.jsx("span",{className:l.error,children:a.error}),r.jsx("input",{type:"password",id:"new-password",onChange:r=>i({value:r.target.value,error:""})})]}),r.jsxs("div",{className:l["input-wrapper"],children:[r.jsx("label",{htmlFor:"confirm-password",children:"Confirm Password"}),u.value.length>0&&r.jsx("span",{className:l.error,children:u.error}),r.jsx("input",{type:"password",id:"confirm-password",onChange:r=>d({value:r.target.value,error:""})})]}),r.jsx("button",{className:l.button,disabled:a.error.length>0||u.error.length>0,children:"Change Password"})]}),r.jsx("a",{className:l["back-link"],onClick:()=>e(!1),children:"Back"})]})},h=()=>{const{user:e,logOut:o}=s.useContext(t),a=n(),[i,c]=s.useState(!1);if(!e)return a("/auth"),null;return r.jsx("div",{className:l["settings-page"],children:i?r.jsx(m,{setChangePassOpened:c}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>a("/orders"),className:l.button,children:"Orders"}),r.jsx(p,{setChangePassOpened:c}),r.jsx(d,{}),r.jsx(u,{logOut:o})]})})},g=()=>r.jsx(h,{});export{g as default};
